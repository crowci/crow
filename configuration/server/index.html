<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../ rel=prev><link href=../agent/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.49"><title>Server - Crow CI</title><link rel=stylesheet href=../../assets/stylesheets/main.6f8fc17f.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel="stylesheet" href="../../assets/external/fonts.googleapis.com/css.49ea35f2.css"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#forge-user-configuration class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Crow CI" class="md-header__button md-logo" aria-label="Crow CI" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Crow CI </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Server </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=custom-light data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href="https://github.com/crowci/crow" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=../../installation/ class=md-tabs__link> Installation </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> Configuration </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Crow CI" class="md-nav__button md-logo" aria-label="Crow CI" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Crow CI </label> <div class=md-nav__source> <a href="https://github.com/crowci/crow" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Getting started </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Configuration </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Server </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Server </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#forge-user-configuration class=md-nav__link> <span class=md-ellipsis> Forge &amp; User configuration </span> </a> </li> <li class=md-nav__item> <a href=#admin-users class=md-nav__link> <span class=md-ellipsis> Admin users </span> </a> </li> <li class=md-nav__item> <a href=#database class=md-nav__link> <span class=md-ellipsis> Database </span> </a> <nav class=md-nav aria-label=Database> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sqlite class=md-nav__link> <span class=md-ellipsis> SQLite </span> </a> </li> <li class=md-nav__item> <a href=#postgres class=md-nav__link> <span class=md-ellipsis> Postgres </span> </a> </li> <li class=md-nav__item> <a href=#mysqlmariadb class=md-nav__link> <span class=md-ellipsis> MySQL/MariaDB </span> </a> </li> <li class=md-nav__item> <a href=#migration class=md-nav__link> <span class=md-ellipsis> Migration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#backend class=md-nav__link> <span class=md-ellipsis> Backend </span> </a> <nav class=md-nav aria-label=Backend> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> <nav class=md-nav aria-label=Docker> <ul class=md-nav__list> <li class=md-nav__item> <a href=#backend-options class=md-nav__link> <span class=md-ellipsis> Backend Options </span> </a> </li> <li class=md-nav__item> <a href=#housekeeping class=md-nav__link> <span class=md-ellipsis> Housekeeping </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kubernetes class=md-nav__link> <span class=md-ellipsis> Kubernetes </span> </a> </li> <li class=md-nav__item> <a href=#private-registries class=md-nav__link> <span class=md-ellipsis> Private Registries </span> </a> </li> <li class=md-nav__item> <a href=#backend-options_1 class=md-nav__link> <span class=md-ellipsis> Backend options </span> </a> <nav class=md-nav aria-label="Backend options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#general class=md-nav__link> <span class=md-ellipsis> General </span> </a> </li> <li class=md-nav__item> <a href=#noteworthy-options-and-adaptations class=md-nav__link> <span class=md-ellipsis> Noteworthy options and adaptations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#local class=md-nav__link> <span class=md-ellipsis> Local </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#metrics class=md-nav__link> <span class=md-ellipsis> Metrics </span> </a> </li> <li class=md-nav__item> <a href=#ssl class=md-nav__link> <span class=md-ellipsis> SSL </span> </a> </li> <li class=md-nav__item> <a href=#logging class=md-nav__link> <span class=md-ellipsis> Logging </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../agent/ class=md-nav__link> <span class=md-ellipsis> Agent </span> </a> </li> <li class=md-nav__item> <a href=../autoscaler/ class=md-nav__link> <span class=md-ellipsis> Autoscaler </span> </a> </li> <li class=md-nav__item> <a href=../env-vars/ class=md-nav__link> <span class=md-ellipsis> All environment variables </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#forge-user-configuration class=md-nav__link> <span class=md-ellipsis> Forge &amp; User configuration </span> </a> </li> <li class=md-nav__item> <a href=#admin-users class=md-nav__link> <span class=md-ellipsis> Admin users </span> </a> </li> <li class=md-nav__item> <a href=#database class=md-nav__link> <span class=md-ellipsis> Database </span> </a> <nav class=md-nav aria-label=Database> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sqlite class=md-nav__link> <span class=md-ellipsis> SQLite </span> </a> </li> <li class=md-nav__item> <a href=#postgres class=md-nav__link> <span class=md-ellipsis> Postgres </span> </a> </li> <li class=md-nav__item> <a href=#mysqlmariadb class=md-nav__link> <span class=md-ellipsis> MySQL/MariaDB </span> </a> </li> <li class=md-nav__item> <a href=#migration class=md-nav__link> <span class=md-ellipsis> Migration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#backend class=md-nav__link> <span class=md-ellipsis> Backend </span> </a> <nav class=md-nav aria-label=Backend> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> <nav class=md-nav aria-label=Docker> <ul class=md-nav__list> <li class=md-nav__item> <a href=#backend-options class=md-nav__link> <span class=md-ellipsis> Backend Options </span> </a> </li> <li class=md-nav__item> <a href=#housekeeping class=md-nav__link> <span class=md-ellipsis> Housekeeping </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kubernetes class=md-nav__link> <span class=md-ellipsis> Kubernetes </span> </a> </li> <li class=md-nav__item> <a href=#private-registries class=md-nav__link> <span class=md-ellipsis> Private Registries </span> </a> </li> <li class=md-nav__item> <a href=#backend-options_1 class=md-nav__link> <span class=md-ellipsis> Backend options </span> </a> <nav class=md-nav aria-label="Backend options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#general class=md-nav__link> <span class=md-ellipsis> General </span> </a> </li> <li class=md-nav__item> <a href=#noteworthy-options-and-adaptations class=md-nav__link> <span class=md-ellipsis> Noteworthy options and adaptations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#local class=md-nav__link> <span class=md-ellipsis> Local </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#metrics class=md-nav__link> <span class=md-ellipsis> Metrics </span> </a> </li> <li class=md-nav__item> <a href=#ssl class=md-nav__link> <span class=md-ellipsis> SSL </span> </a> </li> <li class=md-nav__item> <a href=#logging class=md-nav__link> <span class=md-ellipsis> Logging </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href="https://github.com/crowci/crow/edit/main/docs/configuration/server.md" title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <h1>Server</h1> <h2 id=forge-user-configuration>Forge &amp; User configuration</h2> <p>Crow can only be used in combination with a "Forge" (i.e. Git Provider). The following ones are currently supported:</p> <ul> <li>GitHub</li> <li>GitLab</li> <li>Gitea</li> <li>Forgejo</li> <li>Bitbucket Datacenter</li> </ul> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class="l l-Scalar l-Scalar-Plain">CROW_FORGE=github</span><span class=w> </span><span class=c1># gitlab,gitea,forgejo,bitbucket</span>
</span></code></pre></div> <p>As Crow does not have its own user registry, users are provided from the linked forge via OAuth2. <strong>There is no way to register users manually.</strong></p> <p>Registration is closed by default (<code>CROW_OPEN=false</code>). If registration is open (<code>CROW_OPEN=true</code>) then every user with an account at the configured forge can login and by this register an account.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> </div> <p>It is highly recommended to restrict login to a specific subset of users, e.g. members of an organization. Otherwise, there is no control about who can register and create repositories to run pipelines. This is also recommended for <em>private</em> Crow instances. Org-based restrictions can be done by setting <code>CROW_ORGS</code>:</p> <div class="language-text highlight"><pre><span></span><code>```yaml
CROW_ORGS=org1
```

This would limit the use of Crow to member of this organization, allowing administrative control about users.
</code></pre></div> <h2 id=admin-users>Admin users</h2> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class="l l-Scalar l-Scalar-Plain">CROW_ADMIN=johnDoe,janeSmith</span>
</span></code></pre></div> <p>Besides setting this env var, admins can also be promoted manually in the UI by existing admins (<code>Settings -&gt; Users -&gt; Edit User</code>).</p> <h2 id=database>Database</h2> <h3 id=sqlite>SQLite</h3> <p>Crow uses a SQLite database stored under <code>/var/lib/CROW/</code>.</p> <!-- FIXME: add link to section --> <p>When using the docker-compose installation, make sure to persist (and backup) the volume serving this directory.</p> <h3 id=postgres>Postgres</h3> <p>Postgres &gt;= 11 is currently supported.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class="l l-Scalar l-Scalar-Plain">CROW_DATABASE_DRIVER=postgres</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class="l l-Scalar l-Scalar-Plain">CROW_DATABASE_DATASOURCE=postgres://&lt;user&gt;:&lt;pw&gt;@0.0.0.0:5432/&lt;dbname&gt;?sslmode=disable</span>
</span></code></pre></div> <h3 id=mysqlmariadb>MySQL/MariaDB</h3> <p>The minimum version of MySQL/MariaDB required is determined by the <code>go-sql-driver/mysql</code> - see <a href="https://github.com/go-sql-driver/mysql#requirements">its README</a> for more information.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class="l l-Scalar l-Scalar-Plain">CROW_DATABASE_DRIVER=mysql</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class="l l-Scalar l-Scalar-Plain">CROW_DATABASE_DATASOURCE=&lt;user&gt;:&lt;pw&gt;@tcp(0.0.0.0:3306)/&lt;dbname&gt;?parseTime=true</span>
</span></code></pre></div> <h3 id=migration>Migration</h3> <p>Crow automatically handles database migrations, i.e. when the schema changes in a new version, the changes are applied during version upgrade. This also means that reverting to an old version after such a migration is not supported.</p> <h2 id=backend>Backend</h2> <p>The backend specifies how and where builds are executed. There are two production-grade backends:</p> <ul> <li><code>docker</code></li> <li><code>kubernetes</code></li> </ul> <p>In addition, the <code>local</code> backends exists which allows executing pipelines on the local machine that runs the agent directly.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> </div> <p>the <code>local</code> backend is aimed at local debugging and development and should not be used in production.</p> <div class="admonition info"> <p class=admonition-title>Info</p> </div> <p>Podman is not supported as a backend and cannot be used as a backend engine for the "docker" backend. This backend needs a dedicated integration using the podman-specific golang libraries. Contributions welcome!</p> <h3 id=docker>Docker</h3> <p>The <code>docker</code> backend can be seen as the "default" backend. It executes each step inside a separate container started on the agent.</p> <h4 id=backend-options>Backend Options</h4> <p>The following <code>backend_options</code> are available:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nt>steps</span><span class=p>:</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">test</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>  </span><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>    </span><span class=nt>backend_options</span><span class=p>:</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>      </span><span class=nt>docker</span><span class=p>:</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>        </span><span class=c1># same as &#39;docker run --user&#39;</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>        </span><span class=nt>user</span><span class=p>:</span>
</span></code></pre></div> <h4 id=housekeeping>Housekeeping</h4> <p>Crow will not automatically clean up images from the Docker installation on the host. Doing so needs extra configuration and should be included as a regular system maintenance task.</p> <p>Here are a few helper commands related to image cleanup:</p> <p><strong>Removing all unused images</strong>:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>docker<span class=w> </span>image<span class=w> </span>rm<span class=w> </span><span class=k>$(</span>docker<span class=w> </span>images<span class=w> </span>--filter<span class=w> </span><span class=s2>&quot;dangling=true&quot;</span><span class=w> </span>-q<span class=w> </span>--no-trunc<span class=k>)</span>
</span></code></pre></div> <p><strong>Removing dangling/unused Crow volumes</strong>:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>docker<span class=w> </span>volume<span class=w> </span>rm<span class=w> </span><span class=k>$(</span>docker<span class=w> </span>volume<span class=w> </span>ls<span class=w> </span>--filter<span class=w> </span><span class=nv>name</span><span class=o>=</span>^crow_*<span class=w> </span>--filter<span class=w> </span><span class=nv>dangling</span><span class=o>=</span><span class=nb>true</span><span class=w> </span>-q<span class=k>)</span>
</span></code></pre></div> <p><strong>Pruning all images older than 30 days if the underlying file system partition has reached a certain size</strong>:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># prune when disk usage &gt; 300GB</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>df<span class=w> </span>-k<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-E<span class=w> </span><span class=s1>&#39;/var/lib/docker$&#39;</span><span class=w> </span><span class=p>|</span><span class=w> </span>awk<span class=w> </span><span class=s1>&#39;{if ($3 &gt; 300000000) system(&quot;docker image prune -f -a --filter until=720h&quot;)}&#39;</span>
</span></code></pre></div> <h3 id=kubernetes>Kubernetes</h3> <p>The Kubernetes backend executes steps inside standalone Pods. For every pipeline, a temporary PVC is created for the lifetime of the pipeline to transfer files between steps.</p> <p>Every step is executed in a distinct pod. This allows every step to be run on a different node, ensuring maximum flexibility with respect to resource distribution.</p> <div class="admonition info"> <p class=admonition-title>Info</p> </div> <p>There are plans to add a "one pod per pipeline" setting which executes all steps as containers of a single pod. This has the advantage of not requiring a RWX volume for file persistence between pods but would at the same time reduce the scheduling flexibility (as it would require the pod to be scheduled on a node that can take the step with the higher resource need).</p> <h3 id=private-registries>Private Registries</h3> <p>Images from private registries require authentication. This is commonly done by providing a <code>imagePullSecret</code> in Kubernetes.</p> <p>To do so, the env var <code>CROW_BACKEND_K8S_PULL_SECRET_NAMES</code> can be used. It references <strong>existing Kubernetes secrets</strong> which contain registry pull secrets and allows the <code>agent</code> to make use of these in a specific namespace (defined via <code>CROW_BACKEND_K8S_NAMESPACE</code>) during pipeline creation.</p> <p>The Kubernetes secret must be of type <code>kubernetes.io/dockerconfigjson</code> and look like:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=err>.dockerco</span><span class=kc>nf</span><span class=err>igjso</span><span class=kc>n</span><span class=p>:</span><span class=w> </span><span class=err>&#39;</span><span class=p>{</span><span class=nt>&quot;auths&quot;</span><span class=p>:{</span><span class=nt>&quot;https://index.docker.io/v1/&quot;</span><span class=p>:{</span><span class=nt>&quot;auth&quot;</span><span class=p>:</span><span class=s2>&quot;&lt;auth&gt;&quot;</span><span class=p>,</span><span class=nt>&quot;password&quot;</span><span class=p>:</span><span class=s2>&quot;&lt;pw&gt;&quot;</span><span class=p>,</span><span class=nt>&quot;username&quot;</span><span class=p>:</span><span class=s2>&quot;&lt;username&gt;&quot;</span><span class=p>}}}</span><span class=err>&#39;</span>
</span></code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> </div> <p>The secret value can be obtained by issuing a local login to the registry and then extracting the created config value from <code>~/.docker/config.json</code>.</p> <h3 id=backend-options_1>Backend options</h3> <p>The Kubernetes backend allows specifying requests and limits on a per-step basic, most commonly for CPU and memory.</p> <div class="admonition note"> <p class=admonition-title>Note</p> </div> <p>Adding a <code>resources</code> definition to all steps is essential for the Kubernetes backend to ensure efficient scheduling.</p> <h4 id=general>General</h4> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=nt>steps</span><span class=p>:</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;Kubernetes</span><span class=nv> </span><span class=s>step&#39;</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">alpine</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>    </span><span class=nt>commands</span><span class=p>:</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello world&quot;</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>    </span><span class=nt>backend_options</span><span class=p>:</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>      </span><span class=nt>kubernetes</span><span class=p>:</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w>        </span><span class=nt>resources</span><span class=p>:</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=w>          </span><span class=nt>requests</span><span class=p>:</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">200Mi</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100m</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=w>          </span><span class=nt>limits</span><span class=p>:</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">400Mi</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1000m</span>
</span></code></pre></div> <p>The following other common pod settings in Kubernetes are supported in <code>backend_options</code> using the same syntax as in Kubernetes:</p> <ul> <li>nodeSelector</li> <li>volumes</li> <li>tolerations</li> <li>securityContext</li> <li>annotations</li> <li>labels</li> </ul> <p>If your unfamiliar with some, please check the corresponding upstream documentation in Kubernetes.</p> <h4 id=noteworthy-options-and-adaptations>Noteworthy options and adaptations</h4> <p>In the following, special/uncommon settings are explained in more detail.</p> <ul> <li> <p><a href="https://kubernetes.io/docs/concepts/policy/limit-range/">Limit Ranges</a> can be used to set the limits by per-namespace basis.</p> </li> <li> <p><code>runtimeClassName</code> specifies the name of the <code>RuntimeClass</code> which will be used to run the Pod. If <code>runtimeClassName</code> is not set, the default <code>RuntimeHandler</code> will be used. See the <a href="https://kubernetes.io/docs/concepts/containers/runtime-class/">Kubernetes documentation on runtime classes</a> for more information.</p> </li> <li> <p>To allow annotations and labels, the env var <code>WOODPECKER_BACKEND_K8S_POD_ANNOTATIONS_ALLOW_FROM_STEP</code> and/or <code>WOODPECKER_BACKEND_K8S_POD_LABELS_ALLOW_FROM_STEP</code> must be set to <code>true</code>.</p> </li> <li> <p>Users of <a href="https://github.com/cri-o/cri-o">crio-o</a> need to configure the workspace for all pipelines centrally in order ensure correct execution (see <a href="https://github.com/woodpecker-ci/woodpecker/issues/2510">this issue</a>): <div class="language-yaml highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=nt>workspace</span><span class=p>:</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=nt>base</span><span class=p>:</span><span class=w> </span><span class=s>&#39;/woodpecker&#39;</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s>&#39;/&#39;</span>
</span></code></pre></div></p> </li> </ul> <h3 id=local>Local</h3> <h2 id=metrics>Metrics</h2> <h2 id=ssl>SSL</h2> <h2 id=logging>Logging</h2> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Index"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Index </div> </div> </a> <a href=../agent/ class="md-footer__link md-footer__link--next" aria-label="Next: Agent"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Agent </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 - 2025 Crow CI – <a href=#__consent>Change cookie settings</a> </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.prune", "navigation.indexes", "navigation.footer", "navigation.top", "search.suggest", "search.highlight", "header.autohide", "content.action.edit", "content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.88dd0f4e.min.js></script> <script src="../../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script> <script id="init-glightbox">document.querySelectorAll('.glightbox').forEach(function(element) {
    try {
        var img = element.querySelector('img');
        if (img && img.src) {
            element.setAttribute('href', img.src);
        } else {
            console.log('No img element with src attribute found');
        }
    } catch (error) {
        console.log('Error:', error);
    }
});
const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "fade", "closeEffect": "fade", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>